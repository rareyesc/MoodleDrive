<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Ingresar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
          rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
          crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/estilosForm.css}"/>
    <link rel="stylesheet" th:href="@{/css/all.min.css}"/>
    <link rel="stylesheet" th:href="@{/css/sb-admin-2.min.css}"/>
    <link rel="icon" th:href="@{/images/Icono_SM.ico}" type="image/x-icon">
</head>

<body class="bg-primary">
<!-- CONTENEDOR PRINCIPAL -->
<div class="container">
    <!-- CONTENEDOR DE COLUMNA -->
    <div class="row justify-content-center">
        <!-- CONTENEDOR SEPARADOR -->
        <div class="col-xl-10 col-lg-12 col-md-9">
            <!-- CONTENEDOR CARD -->
            <div class="card o-hidden border border-0 bs-box-shadow-lg my-5">
                <!-- CONTENEDOR CARD-BODY -->
                <div class="card-body p-0">
                    <!-- MANEJO DE LA PAGINA EN COLUMNA -->
                    <div class="row">
                        <!-- IMAGEN EN LA PRIMER COLUMNA -->
                        <div class="col-lg-6 d-none d-lg-block bg-login-image rounded-start-2"></div>
                        <!-- FIN IMAGEN EN LA PRIMER COLUMNA -->
                        <!-- DISTRIBUCION EN 6 COLUMNAS -->
                        <div class="col-lg-6">
                            <!-- CONTENEDOR CON PADDING -->
                            <div class="p-5">
                                <!-- CONTENEDOR DE TEXTO CENTRADO -->
                                <div class="text-center">
                                    <!-- TITULO DE CUERPO DEL FORMULARIO -->
                                    <h1 class="h4 text-gray-900 mb-4">¡Bienvenido!</h1>
                                    <!-- FIN TITULO DE CUERPO DEL FORMULARIO -->
                                </div>
                                <!-- FIN CONTENEDOR DE TEXTO CENTRADO -->
                                <!-- INICIO DEL FORMULARIO -->
                                <form th:action="@{/login/user}" method="POST" id="loginForm" class="user"
                                      name="formLogin">
                                    <!-- CONTENEDOR GRUPAL DE CORREO ELECTRONICO -->
                                    <div class="form-group mb-3">
                                        <!-- INPUT DE CORREO ELECTRONICO -->
                                        <input type="email" class="form-control form-control-user" id="txtEmail"
                                               placeholder="Correo Electr&oacute;nico" name="email" required/>
                                        <!-- FIN INPUT DE CORREO ELECTRONICO -->
                                    </div>
                                    <!-- FIN CONTENEDOR GRUPAL DE CORREO ELECTRONICO -->
                                    <!-- CONTENEDOR GRUPAL DE CONTRASEÑA -->
                                    <div class="form-group mb-3">
                                        <!-- INPUT DE CONTRASEÑA -->
                                        <input type="password" class="form-control form-control-user" id="txtpass"
                                               placeholder="Contrase&ntilde;a" name="password" required/>
                                        <!-- FIN INPUT DE CONTRASEÑA -->
                                    </div>
                                    <!-- FIN CONTENEDOR GRUPAL DE CONTRASEÑA -->
                                    <!-- SALTO DE LINEA CON SEPARADOR DE LINEA -->
                                    <hr/>
                                    <!-- FIN SALTO DE LINEA CON SEPARADOR DE LINEA -->
                                    <!-- BOTON DE ENVIO DEL FORMULARIO LOGIN -->
                                    <button type="submit" class="btn btn-primary">Ingresar</button>
                                    <!-- FIN BOTON DE ENVIO DEL FORMULARIO LOGIN -->
                                </form>
                                <!-- FIN INICIO DEL FORMULARIO -->
                                <!-- SALTO DE LINEA CON SEPARADOR DE LINEA -->
                                <hr/>
                                <!-- FIN SALTO DE LINEA CON SEPARADOR DE LINEA -->
                                <!-- CONTENEDOR PARA OLVIDAR CONTRASENIA -->
                                <div class="text-center">
                                    <!-- LINK HACIA OLVIDAR CONTRASENIA -->
                                    <a class="small" th:href="@{/forgot/password}">Olvid&eacute; mi
                                        Contrase&ntilde;a</a>
                                    <!-- FIN LINK HACIA OLVIDAR CONTRASENIA -->
                                </div>
                                <!-- FIN CONTENEDOR PARA OLVIDAR CONTRASENIA -->
                                <!-- CONTENEDOR PARA CREAR CUENTA -->
                                <div class="text-center">
                                    <!-- LINK HACIA CREAR CUENTA -->
                                    <a class="small" th:href="@{/registrar/formulario}">¡Crea una Cuenta!</a>
                                    <!-- FIN LINK HACIA CREAR CUENTA -->
                                </div>
                                <!-- FIN CONTENEDOR PARA CREAR CUENTA -->
                            </div>
                            <!-- FIN CONTENEDOR CON PADDING -->
                        </div>
                        <!-- FINDISTRIBUCION EN 6 COLUMNAS -->
                    </div>
                    <!-- FIN MANEJO DE LA PAGINA EN COLUMNA -->
                </div>
                <!-- FIN CONTENEDOR CARD-BODY -->
            </div>
            <!-- FIN CONTENEDOR CARD -->
        </div>
        <!-- FIN CONTENEDOR SEPARADOR -->
    </div>
    <!-- FIN CONTENEDOR DE COLUMNA -->
</div>
<!-- FIN CONTENEDOR PRINCIPAL -->

<div class="modal fade" id="usuarioPassIncorrecto" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Error de Logueo</h5>
                <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">El usuario o la contrase&ntilde;a son incorrectos.</div>
            <div class="modal-footer">
                <button class="btn btn-danger" type="button" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="usuarioInactivo" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Error de Logueo</h5>
                <button class="btn-close" type="button" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">El usuario está inactivo. Por favor, contacta al administrador.</div>
            <div class="modal-footer">
                <button class="btn btn-danger" type="button" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- INPUT OCULTO ALMACENA CAMPOS VACIOS -->
<input type="hidden" id="campos_vacios" th:value="${campos_vacios}">
<!-- FIN INPUT OCULTO ALMACENA CAMPOS VACIOS -->
<div class="modal fade" id="campos_vacios" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Error de Logueo</h5>
                <button class="btn-close" type="button" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">El email y la contrase&ntilde;a con obligatorios.</div>
            <div class="modal-footer">
                <button class="btn btn-danger" type="button" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<script>
    window.onload = function() {
        if (window.history.replaceState) {
            window.history.replaceState(null, null, window.location.href);
        }
    }
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
<script th:inline="javascript">
    var errorType = /*[[${session.errorType}]]*/ 'defaultError';

    $(document).ready(function() {
        if (errorType === 'invalid_credentials') {
            $('#usuarioPassIncorrecto').modal('show', function() {
                errorType = null;  // Reset the errorType after showing the modal
            });
        } else if (errorType === 'user_disabled') {
            $('#usuarioInactivo').modal('show', function() {
                errorType = null;  // Reset the errorType after showing the modal
            });
        } else if (errorType) {
            console.log('Error Desconocido: ' + errorType);
        }
    });


</script>

</body>
</html>